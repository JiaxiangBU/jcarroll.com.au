<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Adding strings in R - Irregularly Scheduled Programming</title>
  <meta property="og:title" content="Adding strings in R" />
  <meta name="twitter:title" content="Adding strings in R" />
  <meta name="description" content="This started out as a &ldquo;hey, I wonder&hellip;&rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up and share. Shoutout to @coolbutuseless for proving that a little curiosity can go a long way and inspiring me to keep digging into interesting topics.

[caption align=&ldquo;center&rdquo; width=&ldquo;680&rdquo;] This is what you get if you &quot;glue&quot; &quot;strings&quot;. Photo: https://craftwhack.com/cool-craft-string-easter-eggs/[/caption]">
  <meta property="og:description" content="This started out as a &ldquo;hey, I wonder&hellip;&rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up and share. Shoutout to @coolbutuseless for proving that a little curiosity can go a long way and inspiring me to keep digging into interesting topics.

[caption align=&ldquo;center&rdquo; width=&ldquo;680&rdquo;] This is what you get if you &quot;glue&quot; &quot;strings&quot;. Photo: https://craftwhack.com/cool-craft-string-easter-eggs/[/caption]">
  <meta name="twitter:description" content="This started out as a &ldquo;hey, I wonder&hellip;&rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up …">
  <meta name="author" content="Jonathan Carroll"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Irregularly Scheduled Programming",
    
    "url": "/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "/post/2018-10-06-adding-strings-in-r/",
          "name": "Adding strings in r"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Jonathan Carroll"
  },
  "headline": "Adding strings in R",
  "description" : "This started out as a &amp;ldquo;hey, I wonder&amp;hellip;&amp;rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&amp;rsquo;d write it up and share. Shoutout to @coolbutuseless for proving that a little curiosity can go a long way and inspiring me to keep digging into interesting topics.
[caption align=&amp;ldquo;center&amp;rdquo; width=&amp;ldquo;680&amp;rdquo;]This is what you get if you &amp;quot;glue&amp;quot; &amp;quot;strings&amp;quot;. Photo: https://craftwhack.com/cool-craft-string-easter-eggs/[/caption]
",
  "inLanguage" : "en",
  "wordCount": 1654,
  "datePublished" : "2018-10-06T00:09:15",
  "dateModified" : "2018-10-06T00:09:15",
  "image" : "/img/logo.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "/post/2018-10-06-adding-strings-in-r/",
  "publisher" : {
    "@type": "Organization",
    "name" : "/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "/img/logo.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Adding strings in R" />
<meta property="og:description" content="This started out as a &ldquo;hey, I wonder&hellip;&rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up and share. Shoutout to @coolbutuseless for proving that a little curiosity can go a long way and inspiring me to keep digging into interesting topics.

[caption align=&ldquo;center&rdquo; width=&ldquo;680&rdquo;] This is what you get if you &quot;glue&quot; &quot;strings&quot;. Photo: https://craftwhack.com/cool-craft-string-easter-eggs/[/caption]">
<meta property="og:image" content="/img/logo.png" />
<meta property="og:url" content="/post/2018-10-06-adding-strings-in-r/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Irregularly Scheduled Programming" />
  <meta name="twitter:title" content="Adding strings in R" />
  <meta name="twitter:description" content="This started out as a &ldquo;hey, I wonder&hellip;&rdquo; sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up …">
  <meta name="twitter:image" content="/img/logo.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@carroll_jono" />
  <meta name="twitter:creator" content="@carroll_jono" />
  <link href='/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="/img/logo.png" />
  <meta name="twitter:image" content="/img/logo.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@carroll_jono" />
  <meta name="twitter:creator" content="@carroll_jono" />
  <meta property="og:url" content="/post/2018-10-06-adding-strings-in-r/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Irregularly Scheduled Programming" />

  <meta name="generator" content="Hugo 0.54.0" />
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Irregularly Scheduled Programming">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="/css/highlight.min.css" /><link rel="stylesheet" href="/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135066967-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Irregularly Scheduled Programming</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">About Me</a>
              <div class="navlinks-children">
                
                  <a href="/page/about_jonathan_carroll">Bio</a>
                
                  <a href="/page/cv_jonathan_carroll">CV</a>
                
                  <a href="/page/projects_jonathan_carroll">Projects</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="Book" href="https://beyondspreadsheetswithr.com/">Book</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Irregularly Scheduled Programming" href="/">
            <img class="avatar-img" src="/img/logo.png" alt="Irregularly Scheduled Programming" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Adding strings in R</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on October 6, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;8&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1654&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Jonathan Carroll
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>This started out as a <i>&ldquo;hey, I wonder&hellip;&rdquo;</i> sort of thing, but as usual, they tend to end up as interesting voyages into the deepest depths of code, so I thought I&rsquo;d write it up and share. Shoutout to <a href="https://twitter.com/coolbutuseless">@coolbutuseless</a> for proving that a little curiosity can go a long way and inspiring me to keep digging into interesting topics.</p>

<p>[caption align=&ldquo;center&rdquo; width=&ldquo;680&rdquo;]<img src="https://jcarroll.com.au/wp-content/uploads/2018/10/stringeastereggs.jpg" width="680" height="451" alt="This is what you get if you &quot;glue&quot; &quot;strings&quot;. Photo: https://craftwhack.com/cool-craft-string-easter-eggs/" /> This is what you get if you &quot;glue&quot; &quot;strings&quot;. Photo: <a href="https://craftwhack.com/cool-craft-string-easter-eggs/[/caption">https://craftwhack.com/cool-craft-string-easter-eggs/[/caption</a>]</p>

<p><a href="http://www.happylittlescripts.com/2018/09/make-your-r-code-nicer-with-roperators.html">This post</a> came across my feed last week, referring to the <a href="https://cran.r-project.org/package=roperators">roperators package on CRAN</a>. In that post, the author introduces an infix operator from that package which &lsquo;adds&rsquo; (concatenates/pastes) strings</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
&quot;using infix (%) operators&quot; %+% &quot;R can do simple string addition&quot;
#&gt; [1] &quot;using infix (%) operators R can do simple string addition&quot;
[/code]</p>

<p>This might be familiar if you use python</p>

<p>[code language=&ldquo;python&rdquo; light=&ldquo;true&rdquo;]
&gt;&gt;&gt; &quot;python &quot; + &quot;adds &quot; + &quot;strings&quot;
&lsquo;python adds strings&rsquo;
[/code]</p>

<p>or javascript</p>

<p>[code language=&ldquo;javascript&rdquo; light=&ldquo;true&rdquo;]
&quot;javascript &quot; + &quot;also adds &quot; + &quot;strings&quot;
&quot;javascript also adds strings&quot;
[/code]</p>

<p>or perhaps even go</p>

<p>[code light=&ldquo;true&rdquo;]
package main</p>

<p>import &quot;fmt&quot;</p>

<p>func main() {
  fmt.Println(&quot;go &quot; + &quot;even adds &quot; + &quot;strings&quot;)
}
&gt; &quot;go even adds strings&quot;
[/code]</p>

<p>but this is not something natively available in R</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
&quot;this doesn&rsquo;t&quot; + &quot;work&quot;
#&gt; Error in &quot;this doesn&rsquo;t&quot; + &quot;work&quot; :
#&gt;  non-numeric argument to binary operator
[/code]</p>

<p><img src="https://jcarroll.com.au/wp-content/uploads/2018/10/nazi-240x300.jpg" width="240" height="300" /></p>

<p>Could we make it work, though? That got me wondering. My first guess was to just create a new <code>+</code> function which <i>does</i> allow for this. The normal addition operator is</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
<code>+</code>
#&gt; function (e1, e2)  .Primitive(&quot;+&quot;)
[/code]</p>

<p>so a first attempt might be</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
<code>+</code> &lt;- function(e1, e2) {
  if (is.character(e1) | is.character(e2)) {
    paste0(e1, e2)
  } else {
    base::<code>+</code>(e1, e2)
  }
}
[/code]</p>

<p>This checks to see if the left or right side of the operator is a character-classed object, and if either is, it pastes the two together. Otherwise it just uses the &lsquo;regular&rsquo; addition operator between the two arguments. This works for simple cases, e.g.</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
&quot;a&quot; + &quot;b&quot;
#&gt; [1] &quot;ab&quot;</p>

<p>&quot;a&quot; + 2
#&gt; [1] &quot;a2&quot;</p>

<p>2 + 2
#&gt; [1] 4</p>

<p>2 + &quot;a&quot;
#&gt; [1] &quot;2a&quot;
[/code]</p>

<p>But we hit an important snag if we try to add to character-represented numbers</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
&quot;200&quot; + &quot;200&quot;
#&gt; [1] &quot;200200&quot;
[/code]</p>

<p>That&rsquo;s probably going to be an issue if we read in unformatted data (e.g. from a CSV) as characters and try to treat it like numbers. Normally this would throw the above error about not being numeric, but now we get a silent weird number-character. That&rsquo;s no good.</p>

<p>An extension to this checks whether or not we have the number-as-a-character situation and falls back to the correct interpretation in that case</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
<code>+</code> &lt;- function(e1, e2) {
  ## unary
  if (missing(e2)) return(e1)
  if (!is.na(suppressWarnings(as.numeric(e1))) &amp; !is.na(suppressWarnings(as.numeric(e2)))) {
    ## both arguments numeric-like but characters
    return(base::<code>+</code>(as.numeric(e1), as.numeric(e2)))
  } else if ((is.character(e1) &amp; is.na(suppressWarnings(as.numeric(e1)))) |
             (is.character(e2) &amp; is.na(suppressWarnings(as.numeric(e2))))) {
    ## at least one true character
    return(paste0(e1, e2))
  } else {
    ## both numeric
    return(base::<code>+</code>(e1, e2))
  }
}</p>

<p>&quot;a&quot; + &quot;b&quot;
#&gt; [1] &quot;ab&quot;</p>

<p>&quot;a&quot; + 2
#&gt; [1] &quot;a2&quot;</p>

<p>2 + 2
#&gt; [1] 4</p>

<p>2 + &quot;a&quot;
#&gt; [1] &quot;2a&quot;</p>

<p>&quot;2&quot; + &quot;2&quot;
#&gt; [1] 4</p>

<p>2 + &quot;edgy&quot; + 4 + &quot;me&quot;
#&gt; [1] &quot;2edgy4me&quot;
[/code]</p>

<p>So, that&rsquo;s one option for string addition in R. Is it the right one? The idea of actually dispatching on a character class is inviting. Can we just add a <code>+.character</code> method (since there doesn&rsquo;t seem to already be one)? Normally when we have S3 dispatch we need a generic function, which calls <code>UseMethod(&ldquo;class&rdquo;)</code>, but we don&rsquo;t have that in this case. <code>+</code> is an internal generic, which is probably the first sign that we&rsquo;re going to have trouble. If we try to define the method</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
<code>+.character</code> &lt;- function(e1, e2) {
  paste0(e1, e2)
}
&quot;a&quot; + &quot;b&quot;
#&gt; Error in &quot;a&quot; + &quot;b&quot; : non-numeric argument to binary operator
[/code]</p>

<p>It seems to fail. What went wrong? Is dispatch not working?</p>

<p><iframe src="https://giphy.com/embed/dbtDDSvWErdf2" width="480" height="261" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/richard-ayoade-it-crowd-maurice-moss-dbtDDSvWErdf2">via GIPHY</a></p></p>

<p>We want to dispatch on &ldquo;character&rdquo; &ndash; is that what we have?</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
class(&quot;a&quot;)
#&gt; [1] &quot;character&quot;
[/code]</p>

<p>What if we explicitly create an object with that class?</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
structure(&quot;a&quot;, class = &quot;character&quot;) + 2
#&gt; [1] &quot;a2
2 + structure(&quot;a&quot;, class = &quot;character&quot;)
#&gt; [1] &quot;2a&quot;
[/code]</p>

<p>What if we try to dispatch on some new class?</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
<code>+.foo</code> &lt;- function(e1, e2) {
  paste0(e1, e2)
}
structure(&quot;a&quot;, class = &quot;foo&quot;) + 2
#&gt; [1] &quot;a2
[/code]</p>

<p>but no dice for just a regular atomic character object. Time to revisit the help pages.</p>

<p>In R, addition is limited to particular classes of objects, defined by the Ops group (there are also Math, Summary, and Complex groups). The methods for the Ops group members describe which classes can be involved in operations involving any of the Ops group members:
<code>
&ldquo;+&rdquo;, &ldquo;-&rdquo;, &ldquo;*&ldquo;, &ldquo;/&rdquo;, &ldquo;^&rdquo;, &ldquo;%%&rdquo;, &ldquo;%/%&rdquo;
&ldquo;&amp;&ldquo;, &ldquo;|&rdquo;, &ldquo;!&rdquo;
&ldquo;==&rdquo;, &ldquo;!=&rdquo;, &ldquo;&lt;&ldquo;, &ldquo;&lt;=&ldquo;, &ldquo;&gt;=&rdquo;, &ldquo;&gt;&rdquo;
</code></p>

<p>These methods are:</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
methods(&quot;Ops&quot;)
 [1] Ops,array,array-method<br />
 [2] Ops,array,structure-method<br />
 [3] Ops,nonStructure,nonStructure-method
 [4] Ops,nonStructure,vector-method<br />
 [5] Ops,structure,array-method<br />
 [6] Ops,structure,structure-method<br />
 [7] Ops,structure,vector-method<br />
 [8] Ops,vector,nonStructure-method<br />
 [9] Ops,vector,structure-method<br />
[10] Ops.data.frame<br />
[11] Ops.data.table*<br />
[12] Ops.Date<br />
[13] Ops.difftime<br />
[14] Ops.factor<br />
[15] Ops.numeric_version<br />
[16] Ops.ordered<br />
[17] Ops.POSIXt<br />
[18] Ops.raster*<br />
[19] Ops.roman*<br />
[20] Ops.ts*<br />
[21] Ops.unit*<br />
[/code]</p>

<p>What&rsquo;s missing from this list, in order for us to be able to just use &ldquo;string&rdquo; + &ldquo;string&rdquo; is a character method. What&rsquo;s perhaps even more surprising is that there <i>is</i> a <code>roman</code> method! Whaaaat?</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
as.roman(&quot;1&quot;) + as.roman(&quot;5&quot;)
#&gt; [1] VI
as.roman(&quot;2000&quot;) + as.roman(&quot;18&quot;)
#&gt; [1] MMXVIII
[/code]</p>

<p><img src='https://jcarroll.com.au/wp-content/uploads/2018/10/groove_small.gif' width="500" /></p>

<p>Since the operations need to be defined for all the members of the Ops group, we would also need to define what to do with, say, <code><em></code> between strings. When one side is a string and the other is a number, a reasonable approach might be that which was taken in the original post (using a new infix <code>%s</em>%</code>)</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
&quot;a&quot; %s*% 3
#&gt; [1] &quot;aaa&quot;
[/code]</p>

<p>There is, of course, a function to do this already</p>

<p>[code language=&ldquo;r&rdquo; light=&ldquo;true&rdquo;]
strrep(&quot;a&quot;, 3)
#&gt; [1] &quot;aaa&quot;
[/code]</p>

<p>but I could see creating <code>&ldquo;a&rdquo; * 3</code> as a shortcut to this. I don&rsquo;t know what one would expect <code>&ldquo;a&rdquo; * &ldquo;b&rdquo;</code> to produce.</p>

<p>The problem with where this is heading is that we aren&rsquo;t allowed to create the method for an atomic class, as <a href="https://twitter.com/JorisMeys">Joris Meys</a> and <a href="https://twitter.com/BrodieGaslam">Brodie Gaslam</a> point out on Twitter</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Yes, you&#39;re right.  Below is what I remembered, which suggested that if it were not sealed, it could be defined, but that isn&#39;t true b/c `do_arith` only dispatches on objects (as you point out), although in theory it could dispatch on atomics, but probably doesn&#39;t for speed. <a href="https://t.co/UXk6Tdm3lW">pic.twitter.com/UXk6Tdm3lW</a></p>&mdash; BrodieG (@BrodieGaslam) <a href="https://twitter.com/BrodieGaslam/status/1047838113052155904?ref_src=twsrc%5Etfw">October 4, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

[code language="r" light="true"]
setMethod(&quot;+&quot;, c(&quot;character&quot;, &quot;character&quot;), function(e1, e2) paste0(e1, e2))
#&gt; Error in setMethod(&quot;+&quot;, c(&quot;character&quot;, &quot;character&quot;), function(e1, e2) paste0(e1,  : 
#&gt;   the method for function ‘+’ and signature e1=&quot;character&quot;, e2=&quot;character&quot; is sealed and cannot be re-defined
[/code]

so no luck there. Brodie also links to <a href="https://stackoverflow.com/questions/1319698/why-doesnt-operate-on-characters-in-r/1321491#1321491">a Stack Overflow discussion</a> on this very topic where it is pointed out by <a href="https://twitter.com/MMaechler">Martin Mächler</a> that this has been discussed on <a href="https://stat.ethz.ch/pipermail/r-devel/2006-August/038991.html">r-devel</a> -- that makes for some interesting historical weigh-ins on why this isn't a thing in R. Incidentally, the small-world effect comes into play regarding that Stack Overflow post as one of the three answers happens to be a former work colleague of mine.

So, in the end, it seems the best we can do is the rather long-winded overwrite of <code>+</code> which checks if the arguments really are characters. I don't mind this, and would probably use it if it was in base R or a package. The biggest issue that people seem to have with this is that it 'looks like' addition, but it's not commutative. If that word is new to you, it just means that <code>x + y</code> should give the same answer as <code>y + x</code>. For numbers, the regular </code>+</code> satisfies this:

[code language="r" light="true"]
2 + 3
#&gt; [1] 5
3 + 2
#&gt; [1] 5
[/code]

but when we try to do this with strings... not so much

[code language="r" light="true"]
&quot;a&quot; + &quot;b&quot;
#&gt; [1] &quot;ab&quot;
&quot;b&quot; + &quot;a&quot;
#&gt; [1] &quot;ba&quot;
[/code]

This doesn't particularly bother me, because I'm okay with this not actually being 'mathematical addition'. The fun turn this then took was the suggestion from <a href="https://twitter.com/JorisMeys">Joris Meys</a> that <a href="https://docs.julialang.org/en/stable/manual/mathematical-operations/#Operator-Precedence-and-Associativity-1">Julia's non-associative operators</a> is a strength of the language. There, the way that <a href="https://docs.julialang.org/en/stable/manual/mathematical-operations/#footnote-2">you group values matters</a>

<blockquote>a + b + c is parsed as +(a, b, c) not +(+(a, b), c).</blockquote>

<p><img src="https://jcarroll.com.au/wp-content/uploads/2018/10/wack.gif" width="250", height="188" /></p>

<p>I&rsquo;ll eventually get around to learning more Julia, but this is already hurting my brain.</p>

<p>That distinction may be of interest, however, to <a href="https://twitter.com/MilesMcBain/">Miles McBain</a>, whose concern was more about repeated applications of <code>+</code> being a bottleneck</p>

<p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I hate + for string concatenation. &quot;a&quot; + &quot;b&quot; + &quot;c&quot; is paste(&quot;a&quot;, paste(&quot;b&quot;,&quot;c&quot;)). So you end up copying the data in &quot;b&quot; and &quot;c&quot; twice due to the data being immutable. That can really add up fast with more +&#39;s if you are careless. Like I was in my first programming job.</p>&mdash; Miles McBain (@MilesMcBain) <a href="https://twitter.com/MilesMcBain/status/1047743465562431489?ref_src=twsrc%5Etfw">October 4, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>In that case, parsing as <code>+(&ldquo;a&rdquo;, &ldquo;b&rdquo;, &ldquo;c&rdquo;)</code> is exactly what would be desired.</p>

<p>So, what&rsquo;s the conclusion of all of this? I&rsquo;ve learned (and re-learned) a heap more about how the Ops group works, I&rsquo;ve played a lot with dispatch, and I&rsquo;ve thought deeply about edge-cases for adding strings. I&rsquo;ve also been exposed to a bit more Julia. All in all, a worthwhile dive into something potentially silly, but a lot of fun. If you have some thoughts on the matter, leave a comment here or reply on Twitter &ndash; I&rsquo;d love to hear about another angle to this story.</p>

        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f&amp;text=Adding%20strings%20in%20R&amp;via=carroll_jono" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//plus.google.com/share?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f" target="_blank" title="Share on Google Plus">
          <i class="fab fa-google-plus"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=%2fpost%2f2018-10-06-adding-strings-in-r%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f&amp;title=Adding%20strings%20in%20R" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f&amp;title=Adding%20strings%20in%20R" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f&amp;title=Adding%20strings%20in%20R" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=%2fpost%2f2018-10-06-adding-strings-in-r%2f&amp;description=Adding%20strings%20in%20R" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  
              </div>
            </section>
        

        
          
          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="/post/2018-04-04-reticulate/" data-toggle="tooltip" data-placement="top" title="Constricted development with reticulate">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="/post/2018-10-16-even-more-images-as-x-axis-labels/" data-toggle="tooltip" data-placement="top" title="Even more images as x-axis labels">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          
          <div class="disqus-comments">                  
            <button id="show-comments" class="btn btn-default" type="button">Show <span class="disqus-comment-count" data-disqus-url="post/2018-10-06-adding-strings-in-r">comments</span></button>
            <div id="disqus_thread"></div>

            <script type="text/javascript">
              var disqus_config = function () {
              this.page.url = 'post\/2018-10-06-adding-strings-in-r';
            };

          </script>
          </div>
          
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:website@jcarroll.com.au" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/jonocarroll" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://gitlab.com/jonocarroll" title="GitLab">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-gitlab fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://bitbucket.org/jonocarroll" title="Bitbucket">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-bitbucket fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/carroll_jono" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/carrolljonathan" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/4168169/jonathan-carroll" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://paypal.me/jonocarroll" title="PayPal">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-paypal fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="jcarroll.com.au">Jonathan Carroll</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2019
          

          
            &nbsp;&bull;&nbsp;
            <a href="/">Irregularly Scheduled Programming</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.54.0</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="/js/main.js"></script>
<script src="/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="/js/load-photoswipe.js"></script>







<script type="text/javascript">
$(function(){
  $('#show-comments').on('click', function(){
    var disqus_shortname = 'jcarroll-com-au';
      
    (function() {
      var disqus = document.createElement('script'); 
      disqus.type = 'text/javascript'; 
      disqus.async = true;
      disqus.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(disqus);
    })();
      
    $(this).hide(); 
    });
  });
      
</script>
<script id="dsq-count-scr" src="//jcarroll-com-au.disqus.com/count.js" async></script>




  </body>
</html>

